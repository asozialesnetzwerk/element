(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{1569:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return M}));var o=t(103),c=t.n(o),r=t(106),s=t.n(r),a=t(93),i=t.n(a),l=t(97),u=t(101),d=t(111),f=t(211),m=t(612),b=t(364);var p=t(905),C=t(99),O=t.n(C),h=t(895);var j=t(897);var g=t(141);function v(e,n,t){const o=Object(a.useRef)(null),[c,r]=Object(a.useState)(e),s=Object(a.useCallback)((()=>{o.current&&(o.current.innerHTML=""),null==t||t()}),[o,t]),i=Object(a.useCallback)((e=>{r(e),null==n||n(e)}),[n]),l=Object(a.useCallback)((e=>{e.target instanceof HTMLDivElement&&i(e.target.innerHTML)}),[i]),u=Object(g.b)("MessageComposerInput.ctrlEnterToSend"),d=Object(a.useCallback)((e=>{"Enter"===e.key&&!e.shiftKey&&(!u||u&&e.ctrlKey)&&(e.preventDefault(),e.stopPropagation(),s())}),[u,s]);return{ref:o,onInput:l,onPaste:l,onKeyDown:d,content:c,setContent:i}}var T=t(896),y=t(912);function E(e){let{className:n,disabled:t=!1,onSend:o,onChange:c,children:r,placeholder:s,initialContent:l,leftComponent:u,rightComponent:d}=e;const{ref:f,onInput:m,onPaste:b,onKeyDown:p,content:C,setContent:g}=v(l,c,o),E=function(e,n){return Object(a.useMemo)((()=>({clear:()=>{e.current&&(e.current.innerHTML="")},insertText:t=>{const o=document.getSelection();if(e.current&&o){const c=e.current.innerHTML,{anchorOffset:r,focusOffset:s}=o;e.current.innerHTML=`${c.slice(0,r)}${t}${c.slice(s)}`,Object(h.a)({anchorNode:e.current.firstChild,anchorOffset:r+t.length,focusNode:e.current.firstChild,focusOffset:s+t.length}),n(e.current.innerHTML)}}})),[e,n])}(f,g);!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0;Object(a.useEffect)((()=>{n.current&&(n.current.innerText=e)}),[n,e])}(l,f),Object(T.a)(t,f);const{isFocused:k,onFocus:w}=Object(j.a)(),P=!C&&s||void 0;return i.a.createElement("div",{"data-testid":"PlainTextComposer",className:O()(n,{[`${n}-focused`]:k}),onFocus:w,onBlur:w,onInput:m,onPaste:b,onKeyDown:p},i.a.createElement(y.a,{ref:f,disabled:t,leftComponent:u,rightComponent:d,placeholder:P}),null==r?void 0:r(f,E))}var k=t(254),w=t(884);function P(e){let{selectPreviousSelection:n,menuPosition:t}=e;const o=Object(d.c)();return i.a.createElement(w.a,{menuPosition:t,addEmoji:e=>(n(),l.a.dispatch({action:u.a.ComposerInsert,text:e,timelineRenderingType:o.timelineRenderingType}),!0)})}const S=["isRichTextEnabled","e2eStatus","menuPosition"],x=Object(a.forwardRef)((function(e,n){let{disabled:t=!1,composerFunctions:o}=e;return function(e,n,t){const o=Object(d.c)(),c=Object(a.useRef)(null),r=Object(a.useCallback)((r=>{var s;if(e||null==n||!n.current)return;const a=null!==(s=r.context)&&void 0!==s?s:d.a.Room;switch(r.action){case"reply_to_event":case u.a.FocusSendMessageComposer:Object(m.a)(n,a,o,c);break;case u.a.ClearAndFocusSendMessageComposer:t.clear(),Object(m.a)(n,a,o,c);break;case u.a.ComposerInsert:if(r.timelineRenderingType!==o.timelineRenderingType)break;if(r.composerType!==b.a.Send)break;r.userId||r.event||r.text&&t.insertText(r.text)}}),[e,n,t,c,o]);Object(f.a)(l.a,r)}(t,n,o),null}));function M(e){let{isRichTextEnabled:n,e2eStatus:t,menuPosition:o}=e,r=s()(e,S);const a=n?p.a:E;return i.a.createElement(a,c()({className:"mx_SendWysiwygComposer",leftComponent:t&&i.a.createElement(k.b,{status:t}),rightComponent:e=>i.a.createElement(P,{menuPosition:o,selectPreviousSelection:e})},r),((e,n)=>i.a.createElement(x,{disabled:r.disabled,ref:e,composerFunctions:n})))}}}]);
//# sourceMappingURL=38.js.map